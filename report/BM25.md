# BM25

在进行搜索时，搜索引擎会把相关性高的内容显示在前面。如何计算关键字和内容的相关性，这里有两种重要的度量方法：TF-IDF和BM25.

## TF-IDF

TF(Term Frequency)表示关键字出现的次数，即“词频”。然后考虑到一篇短文可能只出现一次“美食”，而一篇几百页的文章可能会提到两次“美食”，所以我们要消除文档长度的影响，TF = 出现次数/文档长度。

此外，我们注意到某些词比如“的”，“了”这些词会大量出现，但是对文档主题几乎没有贡献，这类词被称为**停用词**，考虑相关性的时候不去考虑它们的词频。同时，我们可以联想“美食”和“食物”，它们的重要性也是不同的。假设我们把世界上所有的文档看做一个文档库，如果一个词很少在文档里出现过，那通过它就可以很容易找到目标，它的权重也应该大。

IDF(Inverted Document Frequency)，即“逆文本频率指数”。假设关键字w在n个文档中出现过，那么n越大，则w的权重越小。IDF=log(N/n)，N表示全部文档数。

## BM25

最新版的lucence不再把TF-IDF作为默认的相关性算法，采用的是BM25(Best Matching)，在tf的计算中增加了一个常数k，用来限制TF值的增长极限。此外，还引入了平均文档长度的概念，单个文档长度对相关性的影响力与它和平均长度的比值有关系，引入另外两个参数，L和b。L是文档长度和平均长度的比值，b是一个常数用来规定L对评分的影响有多大。TF score=((k+1) x tf) / (k x (1-b+bL) + tf).